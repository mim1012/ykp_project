# 📊 Excel 업로드 양식 가이드

## ✅ 필수 컬럼 (반드시 포함되어야 함)

| 컬럼명 | 설명 | 예시 | 필수여부 |
|--------|------|------|----------|
| **개통일** | 개통 날짜 (YYYY-MM-DD) | 2024-01-15 | ✅ 필수 |
| **판매자** | 판매 직원 이름 | 김직원 | ✅ 필수 |
| **대리점** | 대리점 코드 | SM | ✅ 필수 |
| **통신사** | SK, KT, LG, MVNO 중 하나 | SK | ✅ 필수 |
| **개통방식** | 신규, MNP, 기변 중 하나 | 신규 | ✅ 필수 |
| **모델명** | 휴대폰 모델 | iPhone 15 Pro | ✅ 필수 |
| **휴대폰번호** | 전화번호 | 010-1234-5678 | ✅ 필수 |
| **고객명** | 고객 이름 | 홍길동 | ✅ 필수 |
| **생년월일** | 생년월일 | 1990-01-01 | ⭕ 선택 |

## 💰 금액 관련 컬럼 (계산에 사용)

| 컬럼명 | 설명 | 예시 | 기본값 | 계산부호 |
|--------|------|------|--------|----------|
| **액면/셋팅가** | 기본가격 (K) | 100000 | 0 | + |
| **구두1** | 구두 약정 1 (L) | 50000 | 0 | + |
| **구두2** | 구두 약정 2 (M) | 30000 | 0 | + |
| **그레이드** | 등급 지원금 (N) | 20000 | 0 | + |
| **부가추가** | 추가 지원금 (O) | 10000 | 0 | + |
| **서류상현금개통** | 현금개통비 (P) | 30000 | 0 | - |
| **유심비** | USIM 비용 (Q) | 8800 | 0 | + |
| **신규/번이할인** | 신규/번호이동 할인 (R) | 10000 | 0 | + |
| **차감** | 차감액 (S) | 5000 | 0 | - |
| **현금받음** | 현금 수령액 (W) | 20000 | 0 | + |
| **페이백** | 페이백 금액 (X) | 15000 | 0 | - |
| **메모** | 추가 메모 | 참고사항 | - | - |

## 📐 자동 계산되는 필드 (입력 불필요)

시스템이 자동으로 계산하는 필드들:
- **리베총계** (T) = 액면가 + 구두1 + 구두2 + 그레이드 + 부가추가
- **정산금** (U) = 리베총계 - 서류상현금개통 + 유심비 + 신규MNP할인 + 차감
- **세금** (V) = 정산금 × 10%
- **세전마진** (Y) = 정산금 - 세금 + 현금받음 + 페이백
- **세후마진** (Z) = 세금 + 세전마진

## 📝 Excel 파일 예시

### 올바른 양식 예시:
```
| 판매자 | 대리점 | 통신사 | 개통방식 | 모델명 | 개통일 | 휴대폰번호 | 고객명 | 생년월일 | 액면/셋팅가 | 구두1 | 구두2 | 그레이드 | 부가추가 | 서류상현금개통 | 유심비 | 신규/번이할인 | 차감 | 리베총계 | 정산금 | 부/소세 | 현금받음 | 페이백 | 세전마진 | 세후마진 | 메모 |
|--------|--------|--------|----------|--------|---------|-------------|--------|----------|------------|-------|-------|----------|----------|---------------|--------|--------------|------|----------|--------|---------|----------|--------|----------|----------|------|
| 홍길동 | SM | SK | 신규 | iPhone 15 | 2024-01-15 | 010-1234-5678 | 김고객 | 1990-01-01 | 100000 | 50000 | 30000 | 20000 | 10000 | 30000 | 8800 | 10000 | 5000 | (자동계산) | (자동계산) | (자동계산) | 20000 | 15000 | (자동계산) | (자동계산) | - |
| 김직원 | W | KT | MNP | Galaxy S24 | 2024-01-15 | 010-9876-5432 | 박고객 | 1985-05-20 | 90000 | 40000 | 20000 | 15000 | 5000 | 25000 | 8800 | 10000 | 3000 | (자동계산) | (자동계산) | (자동계산) | 15000 | 10000 | (자동계산) | (자동계산) | 특별할인 |
```

## ⚠️ 주의사항

### 1. 통신사 코드
반드시 다음 중 하나여야 함:
- `SK`
- `KT`
- `LG`
- `MVNO` (알뜰폰)

### 2. 대리점 코드
시스템에 등록된 대리점 코드만 사용 가능:
- SM, W, KING, ENTER, UP, TAESUNG, PDM, HANJU, HAPPY 등

### 3. 개통방식
- `신규` - 신규 가입
- `MNP` - 번호이동
- `기변` - 기기변경

### 4. 날짜 형식
- YYYY-MM-DD (예: 2024-01-15)
- YYYY/MM/DD (예: 2024/01/15)
- Excel 날짜 형식도 자동 인식

### 5. 금액 입력
- 숫자만 입력 (콤마, 원 표시 제외)
- 모든 금액은 절댓값으로 입력 (음수 기호 사용 안 함)
- 시스템이 자동으로 더하거나 빼는 계산 수행
- 예: 차감 5000 (5000으로 입력, -5000 아님)

## 🔄 복사-붙여넣기 방법

1. **Excel에서 데이터 준비**
   - 위 양식대로 Excel 파일 작성
   - 헤더 포함하여 전체 선택

2. **복사 (Ctrl+C)**
   - Excel에서 데이터 영역 선택
   - Ctrl+C로 복사

3. **시스템에 붙여넣기**
   - 개통표 입력 페이지 접속
   - 그리드의 첫 번째 셀 클릭
   - Ctrl+V로 붙여넣기

4. **자동 계산**
   - 붙여넣기 즉시 자동 계산
   - 리베총계, 정산금, 마진 등 자동 표시

## 💡 팁

### 대량 데이터 입력시:
1. Excel에서 100개 단위로 나누어 입력
2. 각 배치별로 저장 확인
3. 오류 발생시 해당 행만 수정

### 템플릿 활용:
1. 첫 행에 샘플 데이터 입력
2. 자동 계산 확인
3. 나머지 데이터 입력

### 검증 방법:
1. 몇 개 행만 먼저 테스트
2. 계산 결과 확인
3. 전체 데이터 입력

## 📥 템플릿 다운로드

빈 템플릿이 필요한 경우:
1. 개통표 입력 페이지에서 "템플릿 다운로드" 버튼 클릭
2. 또는 현재 데이터를 Excel로 내보내기 후 수정

## ❓ 자주 묻는 질문

**Q: 컬럼 순서가 달라도 되나요?**
A: 네, 위에 표시된 순서를 권장하지만 헤더명이 정확하면 순서는 상관없습니다.

**Q: 일부 컬럼만 있어도 되나요?**
A: 필수 컬럼은 반드시 있어야 하고, 금액 컬럼은 없으면 0으로 처리됩니다.

**Q: 금액에 음수를 써야 하나요?**
A: 아니요, 모든 금액은 양수로 입력하세요. 시스템이 자동으로 더하거나 빼는 계산을 합니다.

**Q: 한글이 깨지는 경우?**
A: UTF-8 인코딩으로 저장하거나, CSV 대신 XLSX 형식 사용을 권장합니다.

**Q: 최대 몇 개까지 한번에 입력 가능?**
A: 브라우저 성능에 따라 다르지만, 보통 500개씩 나누어 입력을 권장합니다.