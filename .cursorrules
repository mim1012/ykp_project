# Cursor AI Rules for YKP Dashboard

## Project Context
You are working on the YKP ERP Dashboard - a Laravel 12 + React 18 sales management system with role-based access control (RBAC). This is a 1-person development project that uses both **Cursor AI** and **Claude Code** for development.

## Your Role (Cursor AI)
- **Primary Focus**: Frontend development (React, UI/UX, styling)
- **Secondary**: Refactoring, component optimization, accessibility
- **Avoid**: Database migrations, complex backend logic (leave to Claude Code)

## Branching Strategy

### IMPORTANT: Use cursor/* Branches Only
```bash
# ‚úÖ CORRECT - Use cursor/* prefix
cursor/ui-improvements
cursor/refactor-components
cursor/chart-optimization

# ‚ùå WRONG - Don't use these
claude/*     # Reserved for Claude Code
feature/*    # Reserved for manual work
main         # Never work directly on main
```

### Workflow
1. **Create branch**: Always start from `main` with `cursor/*` prefix
2. **Develop**: Make focused changes (UI/UX, components, styling)
3. **Commit**: Use üîÆ emoji prefix (see commit conventions below)
4. **Push & PR**: Push to origin and create PR to `main`
5. **Review**: Request code review from Claude Code (cross-check)
6. **Merge**: Merge after CI passes (no approval needed, 1-person dev)
7. **Cleanup**: Delete branch immediately after merge

## Commit Message Convention

### Format
```
üîÆ <type>(<scope>): <subject>
```

### Examples
```bash
üîÆ feat(ui): add responsive layout for mobile devices
üîÆ style(components): refactor Tailwind classes for consistency
üîÆ fix(ui): correct chart tooltip positioning
üîÆ refactor(hooks): extract custom React hooks for reusability
üîÆ perf(render): optimize component re-renders with React.memo
üîÆ a11y(forms): improve form accessibility with ARIA labels
```

### Commit Types
- `feat`: New UI feature
- `style`: Styling changes (Tailwind, CSS)
- `fix`: UI bug fixes
- `refactor`: Code refactoring (no functional change)
- `perf`: Performance improvements
- `a11y`: Accessibility improvements
- `test`: Adding/updating tests
- `chore`: Maintenance tasks

## Tech Stack & Best Practices

### Frontend (Your Primary Domain)
- **React 18**: Use hooks, avoid class components
- **TailwindCSS v4**: Use utility-first approach, avoid custom CSS
- **AG-Grid**: For Excel-like data entry
- **Chart.js**: For data visualization
- **TanStack Query**: For API state management (5-min cache)
- **Vite**: Build tool with HMR

### Code Style
- **Formatting**: Use Prettier (2 spaces, single quotes)
- **Naming**: camelCase for variables/functions, PascalCase for components
- **Components**: Prefer functional components with hooks
- **Props**: Use TypeScript-style JSDoc for prop types
- **Accessibility**: Always include ARIA labels, keyboard navigation

### Performance Optimization
- Use `React.memo` for expensive components
- Use `useMemo` and `useCallback` appropriately
- Implement virtual scrolling for large lists (AG-Grid, react-window)
- Lazy load images and heavy components
- Code split with dynamic imports

## File Structure

### Frontend Files (Your Focus)
```
resources/js/
‚îú‚îÄ‚îÄ components/      # React components (YOUR PRIMARY AREA)
‚îú‚îÄ‚îÄ hooks/          # Custom React hooks
‚îú‚îÄ‚îÄ pages/          # Page-level components
‚îú‚îÄ‚îÄ providers/      # Context providers
‚îî‚îÄ‚îÄ utils/          # Frontend utilities

resources/views/    # Blade templates (minimize changes)
```

### Files to Avoid Modifying
```
app/                # Laravel backend (Claude Code's domain)
database/           # Migrations, seeders
routes/             # Backend routes
tests/              # Backend tests (unless frontend tests)
```

## API Integration

### Using TanStack Query
```javascript
// ‚úÖ CORRECT - Use existing query hooks
import { useQuery } from '@tanstack/react-query';

const { data, isLoading } = useQuery({
  queryKey: ['sales', filters],
  queryFn: () => fetchSales(filters),
  staleTime: 5 * 60 * 1000, // 5 minutes
});
```

### API Response Format (Read-Only)
```javascript
// Success response
{
  success: true,
  data: mixed,
  meta: { ... }
}

// Error response
{
  success: false,
  error: string,
  code: number
}
```

## Common Tasks

### Adding a New React Component
1. Create component in `resources/js/components/`
2. Use functional component with hooks
3. Add PropTypes or JSDoc comments
4. Export from component file
5. Add to relevant page

### Styling with Tailwind
- Use utility classes, avoid custom CSS
- Follow existing color scheme (check existing components)
- Responsive: mobile-first (sm:, md:, lg:, xl:)
- Dark mode: use `dark:` prefix (if enabled)

### Optimizing Performance
1. Check component render count (React DevTools)
2. Apply `React.memo` if component re-renders unnecessarily
3. Use `useMemo` for expensive calculations
4. Use `useCallback` for event handlers passed as props
5. Implement virtualization for long lists

## Integration with Claude Code

### When to Defer to Claude Code
- Database schema changes
- API endpoint modifications
- Complex backend logic
- Authentication/authorization changes
- Queue job implementations

### Cross-Review Process
After pushing your `cursor/*` branch:
```bash
# 1. Push your branch
git push origin cursor/your-feature

# 2. Create PR to main

# 3. Ask Claude Code to review (in their IDE)
# Message: "Please review cursor/your-feature for:
#   - Code quality
#   - Performance issues
#   - Security concerns
#   - Integration with backend"
```

## Testing

### Frontend Tests
- Use Playwright for E2E tests (`npm run test:smoke`)
- Test user interactions, not implementation details
- Focus on critical paths (login, data entry, reports)

### Before Merging
```bash
# Run these checks
npm run build          # Ensure builds successfully
npm run test:smoke     # Run smoke tests (if applicable)
```

## AI Collaboration Guidelines

### Your Strengths (Cursor)
‚úÖ UI/UX improvements
‚úÖ Component refactoring
‚úÖ Styling with Tailwind
‚úÖ Frontend performance optimization
‚úÖ Accessibility enhancements
‚úÖ React best practices

### Claude Code's Strengths
‚úÖ Backend API development
‚úÖ Database design & migrations
‚úÖ Complex business logic
‚úÖ Security implementations
‚úÖ Queue jobs & background processing
‚úÖ Laravel best practices

### Collaboration Workflow
1. **Clear Separation**: You work on `cursor/*`, Claude works on `claude/*`
2. **Cross-Review**: Review each other's PRs for different perspectives
3. **Communication**: Leave clear commit messages and PR descriptions
4. **Avoid Conflicts**: Don't both work on the same file simultaneously

## Project-Specific Notes

### Role-Based Access Control (RBAC)
The system has 3 roles:
- **headquarters**: Full system access
- **branch**: Branch-specific data only
- **store**: Store-specific sales input only

When building UI, respect these roles:
```javascript
// Example: Hide features based on role
{user.role === 'headquarters' && (
  <UserManagementPanel />
)}
```

### Sales Calculation (Read-Only)
Sales have complex calculations (Î¶¨Î≤†Ï¥ùÍ≥Ñ, Ï†ïÏÇ∞Í∏à, etc.). **DO NOT** modify calculation logic - it's handled by backend `SalesCalculator` helper. Only display calculated values in UI.

### Key API Endpoints (for frontend integration)
```
GET  /api/dashboard/overview         # Dashboard statistics
GET  /api/sales                      # Sales list
POST /api/sales/bulk-save            # Bulk sales import
GET  /api/stores                     # Store list
GET  /api/statistics/sales           # Sales statistics
```

## Emergency Procedures

### If You Accidentally Break main
```bash
# Don't panic! Revert the commit
git revert <commit-hash>
git push origin main

# Or contact the developer immediately
```

### If CI Fails
1. Check GitHub Actions logs
2. Fix issues in your branch
3. Push new commit
4. PR will auto-update

## Quick Reference

### Cursor-Specific Commands
```bash
# Create new cursor branch
git checkout main && git pull && git checkout -b cursor/feature-name

# Commit with proper format
git commit -m "üîÆ feat(ui): add feature description"

# Push and create PR
git push origin cursor/feature-name

# After merge, cleanup
git checkout main && git pull
git branch -d cursor/feature-name
git push origin --delete cursor/feature-name
```

### Useful Resources
- [React 18 Docs](https://react.dev)
- [TailwindCSS v4 Docs](https://tailwindcss.com)
- [AG-Grid React](https://www.ag-grid.com/react-data-grid/)
- [TanStack Query](https://tanstack.com/query/latest)

---

**Remember**: You are part of a 1-person + AI team. Focus on your strengths (UI/UX), collaborate with Claude Code for backend, and always use `cursor/*` branches with üîÆ emoji commits!
