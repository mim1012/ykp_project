# 클로드 코드 자가 확인 질문 가이드

## 🎯 Phase 1: 대리점 프로파일 시스템 구현 확인

### 1-1. 마이그레이션 생성 확인
**Q: DealerProfile 테이블 마이그레이션이 제대로 생성되었나요?**
```bash
# 확인 명령어
php artisan migrate:status
# dealer_profiles 마이그레이션이 목록에 있나요?

ls database/migrations/ | grep dealer_profiles
# 마이그레이션 파일이 존재하나요?
```

**Q: 마이그레이션 파일에 필요한 모든 컬럼이 포함되어 있나요?**
```bash
# 마이그레이션 파일 내용 확인
cat database/migrations/*create_dealer_profiles_table.php
# 다음 컬럼들이 모두 있나요?
# - dealer_code (unique)
# - dealer_name
# - default_sim_fee, default_mnp_discount
# - tax_rate (기본값 0.133)
# - custom_calculation_rules (JSON)
# - status (enum)
```

### 1-2. DealerProfile 모델 확인
**Q: DealerProfile 모델이 올바르게 생성되었나요?**
```bash
# 모델 파일 존재 확인
ls app/Models/DealerProfile.php
# 파일이 존재하나요?

# 모델 로드 테스트
php artisan tinker
>>> App\Models\DealerProfile::class
# 클래스가 정상적으로 로드되나요?
```

**Q: 모델에 필요한 메서드들이 구현되어 있나요?**
```bash
php artisan tinker
>>> $profile = new App\Models\DealerProfile()
>>> method_exists($profile, 'getCalculationDefaults')
# true가 반환되나요?

>>> method_exists($profile, 'isActive')
# true가 반환되나요?

>>> method_exists($profile, 'sales')
# 관계 메서드가 존재하나요?
```

### 1-3. Sales 테이블 업데이트 확인
**Q: Sales 테이블에 dealer_code 컬럼이 추가되었나요?**
```bash
php artisan tinker
>>> Schema::hasColumn('sales', 'dealer_code')
# true가 반환되나요?

>>> Schema::getColumnType('sales', 'dealer_code')
# 'string' 타입이 반환되나요?
```

**Q: Sale 모델에 DealerProfile 관계가 설정되었나요?**
```bash
php artisan tinker
>>> $sale = new App\Models\Sale()
>>> method_exists($sale, 'dealerProfile')
# true가 반환되나요?

>>> method_exists($sale, 'calculateWithProfile')
# 새로운 계산 메서드가 존재하나요?
```

### 1-4. 시더 데이터 확인
**Q: DealerProfileSeeder가 정상적으로 실행되었나요?**
```bash
php artisan db:seed --class=DealerProfileSeeder
# 오류 없이 실행되나요?

php artisan tinker
>>> App\Models\DealerProfile::count()
# 0보다 큰 숫자가 반환되나요?

>>> App\Models\DealerProfile::where('dealer_code', 'ENT')->exists()
# true가 반환되나요?
```

---

## 🎯 Phase 2: 실시간 계산 API 구현 확인

### 2-1. SalesCalculator 확장 확인
**Q: SalesCalculator에 새로운 메서드들이 추가되었나요?**
```bash
php artisan tinker
>>> $calculator = app(App\Helpers\SalesCalculator::class)
>>> method_exists($calculator, 'calculateWithProfile')
# true가 반환되나요?

>>> method_exists($calculator, 'calculateRow')
# true가 반환되나요?

>>> method_exists($calculator, 'calculateBatch')
# true가 반환되나요?
```

**Q: 프로파일 기반 계산이 정상 작동하나요?**
```bash
php artisan tinker
>>> $calculator = app(App\Helpers\SalesCalculator::class)
>>> $testData = ['base_price' => 500000, 'verbal1' => 20000]
>>> $result = $calculator->calculateRow($testData, 'ENT')
>>> isset($result['settlement_amount'])
# true가 반환되나요?

>>> is_numeric($result['settlement_amount'])
# true가 반환되나요?
```

### 2-2. CalculationController 확인
**Q: CalculationController가 생성되었나요?**
```bash
ls app/Http/Controllers/Api/CalculationController.php
# 파일이 존재하나요?

php artisan route:list --path=api/calculation
# 계산 관련 라우트들이 표시되나요?
```

**Q: 계산 API 엔드포인트들이 작동하나요?**
```bash
# 단일 행 계산 테스트
curl -X POST http://localhost:8000/api/calculation/row \
  -H "Content-Type: application/json" \
  -d '{"base_price": 500000, "verbal1": 20000}' \
  | jq '.success'
# true가 반환되나요?

# 대리점 기본값 조회 테스트
curl -X GET "http://localhost:8000/api/calculation/dealer-defaults?dealer_code=ENT" \
  | jq '.success'
# true가 반환되나요?
```

### 2-3. API 라우트 등록 확인
**Q: 모든 계산 API 라우트가 등록되었나요?**
```bash
php artisan route:list --path=api/calculation --columns=Method,URI,Name
# 다음 라우트들이 모두 있나요?
# POST api/calculation/row
# POST api/calculation/batch  
# GET api/calculation/dealer-defaults
# POST api/calculation/validate-formula
```

### 2-4. DealerProfileController 확인
**Q: DealerProfile API 리소스가 작동하나요?**
```bash
php artisan route:list --path=api/dealer-profiles
# RESTful 라우트들이 표시되나요?

curl -X GET http://localhost:8000/api/dealer-profiles | jq 'length'
# 0보다 큰 숫자가 반환되나요?
```

---

## 🎯 Phase 3: 엑셀 스타일 그리드 구현 확인

### 3-1. 프론트엔드 패키지 설치 확인
**Q: AgGrid 관련 패키지들이 설치되었나요?**
```bash
npm list ag-grid-react
# 패키지가 설치되어 있나요?

npm list ag-grid-community
# 패키지가 설치되어 있나요?

npm list react-query
# 패키지가 설치되어 있나요?
```

**Q: package.json에 의존성이 추가되었나요?**
```bash
cat package.json | jq '.dependencies["ag-grid-react"]'
# null이 아닌 버전이 표시되나요?

cat package.json | jq '.dependencies["react-query"]'
# null이 아닌 버전이 표시되나요?
```

### 3-2. SalesGrid 컴포넌트 확인
**Q: SalesGrid 컴포넌트 파일이 생성되었나요?**
```bash
ls resources/js/components/SalesGrid/SalesGrid.tsx
# 파일이 존재하나요?

wc -l resources/js/components/SalesGrid/SalesGrid.tsx
# 100줄 이상의 코드가 있나요?
```

**Q: TypeScript 컴파일 오류가 없나요?**
```bash
npx tsc --noEmit
# 오류 메시지가 없나요?

npm run build
# 빌드가 성공하나요?
```

### 3-3. 메인 페이지 통합 확인
**Q: SalesManagement 페이지가 생성되었나요?**
```bash
ls resources/js/pages/SalesManagement.tsx
# 파일이 존재하나요?

grep -q "SalesGrid" resources/js/pages/SalesManagement.tsx
# SalesGrid 컴포넌트를 import하고 있나요?
```

**Q: React Query가 설정되었나요?**
```bash
grep -q "QueryClient" resources/js/pages/SalesManagement.tsx
# QueryClient가 설정되어 있나요?

grep -q "QueryClientProvider" resources/js/pages/SalesManagement.tsx
# Provider가 설정되어 있나요?
```

### 3-4. Vite 설정 확인
**Q: Vite 빌드가 정상적으로 작동하나요?**
```bash
npm run build
# 빌드 오류가 없나요?

ls public/build/assets/
# 빌드된 파일들이 생성되었나요?
```

**Q: 개발 서버가 정상 실행되나요?**
```bash
# 백그라운드에서 개발 서버 실행 후 확인
npm run dev &
sleep 5
curl -I http://localhost:5173
# 200 OK 응답이 오나요?
```

---

## 🔍 통합 테스트 확인 질문

### 전체 시스템 연동 확인
**Q: Laravel 서버와 프론트엔드가 모두 실행되나요?**
```bash
# Laravel 서버 실행 확인
php artisan serve &
sleep 3
curl -I http://localhost:8000
# 200 OK 응답이 오나요?

# 프론트엔드 서버 실행 확인  
npm run dev &
sleep 5
curl -I http://localhost:5173
# 200 OK 응답이 오나요?
```

**Q: API와 프론트엔드 간 통신이 정상인가요?**
```bash
# 브라우저에서 확인 (개발자 도구 Console에서 실행)
fetch('/api/dealer-profiles')
  .then(r => r.json())
  .then(data => console.log('API 응답:', data.length > 0))
# true가 출력되나요?
```

### 실시간 계산 연동 확인
**Q: 그리드에서 값 변경 시 실시간 계산이 작동하나요?**
```javascript
// 브라우저 개발자 도구에서 실행
// 그리드가 로드된 후 테스트
const gridApi = document.querySelector('.ag-root-wrapper')?.__agGridReact__?.api;
if (gridApi) {
  console.log('그리드 API 사용 가능:', true);
  console.log('총 행 수:', gridApi.getDisplayedRowCount());
} else {
  console.log('그리드 API 사용 불가');
}
// 그리드 API가 사용 가능한가요?
```

---

## 🚨 문제 해결 확인 질문

### 마이그레이션 문제
**Q: 마이그레이션 오류가 발생했나요?**
```bash
php artisan migrate:status | grep "Ran?"
# 모든 마이그레이션이 "Ran"으로 표시되나요?

# 오류 발생 시 롤백 후 재실행
php artisan migrate:rollback
php artisan migrate
# 오류 없이 실행되나요?
```

### API 응답 문제
**Q: API가 올바른 JSON 응답을 반환하나요?**
```bash
curl -X POST http://localhost:8000/api/calculation/row \
  -H "Content-Type: application/json" \
  -d '{"base_price": 500000}' \
  | jq '.success'
# true가 반환되나요?

# 로그 확인
tail -n 20 storage/logs/laravel.log
# 오류 메시지가 없나요?
```

### 프론트엔드 빌드 문제
**Q: 프론트엔드 의존성이 올바르게 설치되었나요?**
```bash
rm -rf node_modules package-lock.json
npm install
# 오류 없이 설치되나요?

npm run build
# 빌드가 성공하나요?
```

---

## ✅ 최종 완료 확인 체크리스트

### Phase 1 완료 확인 질문
- [ ] `dealer_profiles` 테이블이 생성되었나요?
- [ ] `DealerProfile` 모델이 정상 작동하나요?
- [ ] `sales` 테이블에 `dealer_code` 컬럼이 추가되었나요?
- [ ] 기본 대리점 데이터가 시딩되었나요?
- [ ] Sale-DealerProfile 관계가 설정되었나요?

### Phase 2 완료 확인 질문
- [ ] `/api/calculation/row` 엔드포인트가 작동하나요?
- [ ] `/api/calculation/batch` 엔드포인트가 작동하나요?
- [ ] `/api/calculation/dealer-defaults` 엔드포인트가 작동하나요?
- [ ] 프로파일 기반 계산 로직이 작동하나요?
- [ ] API 응답 형식이 일관되나요?

### Phase 3 완료 확인 질문
- [ ] AgGrid 패키지가 설치되었나요?
- [ ] `SalesGrid` 컴포넌트가 렌더링되나요?
- [ ] 실시간 계산 연동이 작동하나요?
- [ ] 행 추가/삭제 기능이 작동하나요?
- [ ] 대리점 필터링이 작동하나요?
- [ ] 통화 포맷팅이 적용되었나요?

**🎉 모든 질문에 "예"라고 답할 수 있다면 구현이 완료된 것입니다!**

